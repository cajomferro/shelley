#device:
#  name: RadioSimplest
#  start_events: [send]
#  behavior:
#    - [send, ?] # como é que poderia fazer para só enviar 1x?
#  components:
#      rs: RadioSimple
#  triggers:
#    send: [rs.start, rs.send, rs.receive, rs.stop]

device:
  name: Radio
  components:
      hc: HTTPClient
      wc: WiFiClient
  events:
    - started:
        start: True
        final: False
        micro:
          seq: [wc.ssid_joined, wc.connected, hc.connected]
    - startfailed:
        start: True
        final: True
        micro:
          xor:
            - seq: [wc.ssid_joined, wc.connected, hc.connect_failed, wc.disconnected, wc.ssid_left]
            - seq: [wc.ssid_joined, wc.connection_timeout]
            - wc.ssid_failed
    - stopped:
        start: False
        final: True
        micro:
          seq: [wc.disconnected, hc.disconnected, wc.ssid_left]
  behavior:
    - [started, stopped]
    - [stopped, started] # this is a restart
    - [startfailed, startfailed] # trying to start but always fails
    - [startfailed, started] # starting after >= 1 fail
    - [stopped, startfailed] # restart fails
#    - send:
#        final: False
#        micro:
#          xor:
#            - hc.get
#            - hc.post
#    - ok:
#        final: False
#        micro: [wc.print_data_ready, hc.response200]
#    - error:
#        final: True
#        micro:
#          - xor:
#              - [wc.print_data_ready, hc.response401]
#              - xor:
#                - [wc.print_data_ready, hc.response401]
#                - xor:
#                  - [wc.print_data_ready, hc.response404]
#                  - xor:
#                    - [wc.print_data_ready, hc.response500]
#                    - [wc.print_timeout]
#          - [wc.disconnected, hc.disconnected]

#    - [notconnected, started]
#    - [notconnected, notconnected]
#    - [send, stopped]
#    - [send, ok]
#    - [send, error]
#    - [ok, send]
#    - [ok, stopped]
#    - [error, stopped]
#    - [stopped, notconnected]


#test_micro:
#  ok:
#    valid1: [wc.ssid_joined, wc.connected, hc.connected, hc.get, wc.print_data_ready, hc.response200, wc.disconnected, hc.disconnected, wc.ssid_left]
#  fail:
#    invalid8: false
#    empty: []