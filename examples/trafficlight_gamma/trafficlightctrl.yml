device:
  name: TrafficLightCtrl
  behavior:
    - [normal_red, normal_green]
    - [normal_red, interrupted_blinkingyellow]
    - [normal_green, normal_yellow]
    - [normal_green, interrupted_blinkingyellow]
    - [normal_yellow, normal_red]
    - [normal_yellow, interrupted_blinkingyellow]
    - [interrupted_blinkingyellow, interrupted_black]
    - [interrupted_blinkingyellow, normal_red]
    - [interrupted_black, interrupted_blinkingyellow]
    - [interrupted_black, normal_red]
  components:
    pi: PoliceInterrupt
    c: Control
    t: Timer
    lc: LightCommands
  events:
    - normal_red:
        start: True
        final: True
        micro:
          xor:
            - seq: [pi.police, c.toggle, lc.displayRed]
            - seq: [c.toggle, lc.displayRed]
    - normal_green:
        start: False
        final: True
        micro: [c.toggle, lc.displayGreen]
    - normal_yellow:
        start: False
        final: True
        micro: [c.toggle, lc.displayYellow]
    - interrupted_blinkingyellow:
        start: False
        final: True
        micro:
          seq:
            - xor:
                - pi.police
                - t.afterms
            - lc.displayYellow
    - interrupted_black:
        start: False
        final: True
        micro: [t.afterms, lc.displayNone]
