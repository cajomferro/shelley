# https://docs.python.org/3.3/library/http.client.html

device:
  name: HTTPClient
  events:
    - connected:
        start: True
        final: False
    - connect_failed:
        start: True
        final: True
    - get:
        start: False
        final: False
    - post:
        start: False
        final: False
    - response200:
        start: False
        final: False
    - response401:
        start: False
        final: False
    - response404:
        start: False
        final: False
    - response500:
        start: False
        final: False
    - disconnected:
        start: False
        final: True
  behavior:
    - [connected, get]  # client.connect(host, port)) succeeded
    - [connected, post]  # client.connect(host, port)) succeeded
    - [connected, connect_failed]  # !client.connect(host, port))
    - [connect_failed, connected]
    - [get, response200]
    - [get, response404]
    - [get, response401]
    - [get, response500]
    - [post, response200]
    - [post, response404]
    - [post, response401]
    - [post, response500]
    - [response200, get]
    - [response200, post]
    - [response200, disconnected]
    - [response404, get]
    - [response404, disconnected]
    - [response404, post]
    - [response401, get]
    - [response401, disconnected]
    - [response401, post]
    - [response500, get]
    - [response500, disconnected]
    - [response500, post]
    - [disconnected, connected]

test_macro:
  ok:
    connect_failed: [connected, connect_failed]
    connect_failed_start: [connect_failed]
    getok: [connected, get, response200, disconnected]
    connect_failed_getok: [connect_failed, connected, get, response200, disconnected]
    postok: [connected, post, response200, disconnected]
    get2x: [connected, get, response404, get, response200, disconnected]
    empty: []
  fail:
    invalid1: [get]
    invalid2: [post]
    invalid3: [response200]
    invalid4: [response404]
    invalid5: [response500]
    invalid6: [disconnected]
    get2x_noresponse: [connected, get, get, response200, disconnected] # response200 missing
    get2x_nodisconnected: [connected, get, response404, get, response200] # response200 is not final state, disconnected missing
    invalid_final: [connected]
