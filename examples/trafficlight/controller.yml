device:
  name: Controller
  behavior:
    - [setup, main_go_sec_stop]
    - [main_go_sec_stop, main_slow_sec_stop]
    - [main_go_sec_stop, blinking]
    - [main_slow_sec_stop, main_stop_sec_go]
    - [main_slow_sec_stop, blinking]
    - [main_stop_sec_go, main_stop_sec_slow]
    - [main_stop_sec_go, blinking]
    - [main_stop_sec_slow, main_go_sec_stop]
    - [main_stop_sec_slow, blinking]
    - [blinking, main_go_sec_stop]
    - [main_go_sec_stop, off]
  components:
    main_rd: TrafficLight
    sec_rd: TrafficLight
    t: Timer
  events:
    - setup:
        start: True
        final: False
        micro: t.begin
    - main_go_sec_stop:
        start: False
        final: False
        micro:
          seq: [t.timeout, main_rd.green, sec_rd.red, t.begin]
    - main_slow_sec_stop:
        start: False
        final: False
        micro:
          seq: [t.timeout, main_rd.yellow, t.begin]
    - main_stop_sec_go:
        start: False
        final: False
        micro:
          seq: [t.timeout, main_rd.red, sec_rd.green, t.begin]
    - main_stop_sec_slow:
        start: False
        final: False
        micro:
          seq: [t.timeout, sec_rd.yellow, t.begin]
    - off:
        start: False
        final: True
        micro:
          seq: [t.timeout, main_rd.off, sec_rd.off]
    - blinking:
        start: False
        final: False
        micro:
          seq:
            - seq: [t.timeout, main_rd.off, sec_rd.off, t.begin]
            - seq: [t.timeout, main_rd.yellow, sec_rd.yellow, t.begin]